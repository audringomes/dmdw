hmLoadTopic({
hmKeywords:"",
hmTitle:"SVG Diagram",
hmDescription:"An easy way to visualize the datamodel objects and relationships is to make use of the existing graphics in the CASE database.",
hmPrevLink:"dmdw_css.html",
hmNextLink:"dmdw_example.html",
hmParentLink:"index.html",
hmBreadCrumbs:"",
hmTitlePath:"SVG Diagram",
hmHeader:"",
hmBody:"<p class=\"p_Normal\">An easy way to visualize the datamodel objects and relationships is to make use of the existing graphics in the CASE database.<\/p>\n\r<p class=\"p_Normal\">The module <span style=\"font-weight: bold;\">ds_svg_writer<\/span> offers a way of creating an intelligent SVG diagram from the CASE database. As SVG it has the big advantage of being pure XML, and styling can be done by css. The file <span style=\"font-weight: bold;\">svg.css<\/span> contains style definitions. For convenience reason this file is in the html resources of the module <span style=\"font-weight: bold;\">ds_doc_writer<\/span>.<\/p>\n\r<p class=\"p_Normal\">The <span style=\"font-weight: bold;\">ds_svg_writer<\/span> is designed for standalone use, but is of course used in the <span style=\"font-weight: bold;\">post_proces()<\/span> of the <span style=\"font-weight: bold;\">dm_xml_writer<\/span>. It uses the exported collections and an open case database (found by the property :case) to export it to the same folder as xml file. It is in the XSLT transform phase embedded in a HTML page.<\/p>\n\r<p class=\"p_Normal\">The case database to be used is defined in the method <span style=\"font-weight: bold;\">dm_xml_writer.opened_case( soc_name )<\/span>.<\/p>\n\r<p class=\"p_Heading2\"><span class=\"f_Heading2\">Principle<\/span><\/p>\n\r<p class=\"p_Normal\">The principle is to pass a set of collections, for example all user tables of a dataset. This collection is expanded with the physical relations that they have, including the heterogeneous ones.<\/p>\n\r<p class=\"p_Normal\">After calculation of the bounds, the geometry is then transformed into SVG pixel space and presented as typical SVG objects.<\/p>\n\r<p class=\"p_Normal\">A case object is represented as a <span style=\"font-weight: bold;\">text<\/span>, the physical relations as a <span style=\"font-weight: bold;\">polyline<\/span>, an hetero table as a <span style=\"font-weight: bold;\">circle<\/span> and the heterogeneous relations as <span style=\"font-weight: bold;\">line<\/span>.<\/p>\n\r<p class=\"p_Normal\">See the page in <a href=\"dmdw_example_2.html\" class=\"topiclink\">Example (2)<\/a>.<\/p>\n\r<p class=\"p_Heading2\"><span class=\"f_Heading2\">Example<\/span><\/p>\n\r<p class=\"p_Normal\">The following proc creates a Diagram with input of all user tables in dataset <span style=\"font-weight: bold;\">DS<\/span>, using case_ds_view <span style=\"font-weight: bold;\">CASE_VIEW<\/span>, and writes the output to the xml resource folder of the module ds_svg_writer.<\/p>\n\r<p class=\"p_Normal\">Because the property <span style=\"font-weight: bold;\">:write_style_element? <\/span>is set, the svg.css is copied into the output if this file does not exist yet.<\/p>\n\r<div class=\"magik\">\n\r    <pre>\n\r<span class=\"magik-font-lock-keyword-statements\"><span class=\"region\">_pragma<\/span><\/span><span class=\"magik-font-lock-pragma\"><span class=\"region\">(classify_level=basic, topic={ds_doc_writer,ds_svg_writer})<\/span><\/span><span class=\"region\">\n\r<\/span><span class=\"doc\"><span class=\"region\">##<\/span><\/span><span class=\"comment\"><span class=\"region\">\n\r<\/span><\/span><span class=\"doc\"><span class=\"region\">## Create a svg image from case database graphics in<\/span><\/span><span class=\"comment\"><span class=\"region\">\n\r<\/span><\/span><span class=\"doc\"><span class=\"region\">## CASE_VIEW. Fetch only the non internal objects from<\/span><\/span><span class=\"comment\"><span class=\"region\">\n\r<\/span><\/span><span class=\"doc\"><span class=\"region\">## dataset DS and write the svg file to OUTPUT_FILE<\/span><\/span><span class=\"comment\"><span class=\"region\">\n\r<\/span><\/span><span class=\"doc\"><span class=\"region\">## The location defaults to xml resource<\/span><\/span><span class=\"comment\"><span class=\"region\">\n\r<\/span><\/span><span class=\"doc\"><span class=\"region\">## folder of this module and the name of the DS.<\/span><\/span><span class=\"comment\"><span class=\"region\">\n\r<\/span><\/span><span class=\"doc\"><span class=\"region\">##<\/span><\/span><span class=\"comment\"><span class=\"region\">\n\r<\/span><\/span><span class=\"doc\"><span class=\"region\">## We use the default properties as specified in<\/span><\/span><span class=\"comment\"><span class=\"region\">\n\r<\/span><\/span><span class=\"doc\"><span class=\"region\">## dm_svg_writer.default_properties, except form the option<\/span><\/span><span class=\"comment\"><span class=\"region\">\n\r<\/span><\/span><span class=\"doc\"><span class=\"region\">## <\/span><\/span><span class=\"magik-font-lock-boolean\"><span class=\"region\">:write_style_element?<\/span><\/span><span class=\"doc\"><span class=\"region\"> <\/span><\/span><span class=\"comment\"><span class=\"region\">\n\r<\/span><\/span><span class=\"doc\"><span class=\"region\">##<\/span><\/span><span class=\"comment\"><span class=\"region\">\n\r<\/span><\/span><span class=\"doc\"><span class=\"region\">## Note that when you see a black square, it most likely<\/span><\/span><span class=\"comment\"><span class=\"region\">\n\r<\/span><\/span><span class=\"doc\"><span class=\"region\">## is missing the CSS style sheet.<\/span><\/span><span class=\"comment\"><span class=\"region\">\n\r<\/span><\/span><span class=\"doc\"><span class=\"region\">##<\/span><\/span><span class=\"comment\"><span class=\"region\">\n\r<\/span><\/span><span class=\"magik-font-lock-keyword-variable\"><span class=\"region\">_global<\/span><\/span><span class=\"region\"> dm_create_svg &lt;&lt;\n\r<\/span><span class=\"magik-font-lock-procedure\"><span class=\"region\">_proc<\/span><\/span><span class=\"region\"> <\/span><span class=\"constant\"><span class=\"region\">@dm_create_svg<\/span><\/span><span class=\"region\">( ds, case_view, <\/span><span class=\"magik-font-lock-keyword-arguments\"><span class=\"region\">_optional<\/span><\/span><span class=\"region\"> output_file )\n\r\n\r        <\/span><span class=\"magik-font-lock-keyword-statements\"><span class=\"region\">_if<\/span><\/span><span class=\"region\"> output_file <\/span><span class=\"magik-font-lock-keyword-operators\"><span class=\"region\">_is<\/span><\/span><span class=\"region\"> <\/span><span class=\"constant\"><span class=\"region\">_unset<\/span><\/span><span class=\"region\"> \n\r        <\/span><span class=\"magik-font-lock-keyword-statements\"><span class=\"region\">_then<\/span><\/span><span class=\"region\">\n\r                l_mod &lt;&lt; sw_module_manager.<\/span><span class=\"function-name\"><span class=\"region\">module<\/span><\/span><span class=\"region\">(<\/span><span class=\"magik-font-lock-symbol\"><span class=\"region\">:ds_svg_writer<\/span><\/span><span class=\"region\">)\n\r                l_dir &lt;&lt; l_mod.<\/span><span class=\"function-name\"><span class=\"region\">resource_list_for<\/span><\/span><span class=\"region\">(<\/span><span class=\"magik-font-lock-symbol\"><span class=\"region\">:xml<\/span><\/span><span class=\"region\">).<\/span><span class=\"magik-font-lock-procedure\"><span class=\"region\">an_element<\/span><\/span><span class=\"region\">()\n\r                output_file &lt;&lt; system.<\/span><span class=\"function-name\"><span class=\"region\">pathname_from_components<\/span><\/span><span class=\"region\">( <\/span><span class=\"magik-font-lock-procedure\"><span class=\"region\">write_string<\/span><\/span><span class=\"region\">(ds.name,<\/span><span class=\"string\"><span class=\"region\">\".svg\"<\/span><\/span><span class=\"region\">),l_dir)\n\r        <\/span><span class=\"magik-font-lock-keyword-statements\"><span class=\"region\">_endif<\/span><\/span><span class=\"region\">\n\r\n\r        <\/span><span class=\"magik-font-lock-keyword-variable\"><span class=\"region\">_local<\/span><\/span><span class=\"region\"> l_props &lt;&lt; property_list.<\/span><span class=\"function-name\"><span class=\"region\">new_with<\/span><\/span><span class=\"region\">(<\/span><span class=\"magik-font-lock-boolean\"><span class=\"region\">:write_style_element?<\/span><\/span><span class=\"region\">,<\/span><span class=\"constant\"><span class=\"region\">_true<\/span><\/span><span class=\"region\">)\n\r        <\/span><span class=\"magik-font-lock-keyword-variable\"><span class=\"region\">_local<\/span><\/span><span class=\"region\"> l_writer &lt;&lt; dm_svg_writer.<\/span><span class=\"function-name\"><span class=\"region\">new<\/span><\/span><span class=\"region\">( case_view, l_props )\n\r        <\/span><span class=\"magik-font-lock-keyword-variable\"><span class=\"region\">_local<\/span><\/span><span class=\"region\"> l_collections &lt;&lt; rope.<\/span><span class=\"function-name\"><span class=\"region\">new_fr<\/span><\/span><span class=\"region\">om_iter(ds,<\/span><span class=\"magik-font-lock-symbol\"><span class=\"region\">:|user_tables()|<\/span><\/span><span class=\"region\">)\n\r\n\r        l_writer.<\/span><span class=\"function-name\"><span class=\"region\">create_svg_for<\/span><\/span><span class=\"region\">( l_collections, output_file )\n\r        \n\r        system.<\/span><span class=\"function-name\"><span class=\"region\">do_command<\/span><\/span><span class=\"region\">( <\/span><span class=\"magik-font-lock-procedure\"><span class=\"region\">write_string<\/span><\/span><span class=\"region\">(<\/span><span class=\"string\"><span class=\"region\">\"swdocopen.exe \"<\/span><\/span><span class=\"region\">, output_file ))\n\r        \n\r<\/span><span class=\"magik-font-lock-procedure\"><span class=\"region\">_endproc<\/span><\/span><span class=\"region\">\n\r\$<\/span><\/pre>\n\r<\/div>\n\r<\/html><p class=\"p_Normal\">&nbsp;<\/p>\n\r"
})
